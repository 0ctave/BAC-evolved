@import "tailwindcss";

/* FIX: Force Tailwind v4 to use class-based dark mode */
@variant dark (&:where(.dark, .dark *));

@theme {
	/* --- FONTS --- */
	--font-heading: "Playfair Display", serif;
	--font-sans: "Lato", sans-serif;

	/* --- COLORS --- */
	/* Limestone */
	--color-limestone-50: #fcfbf7;
	--color-limestone-100: #f7f5ef;
	--color-limestone-200: #efead8;
	--color-limestone-300: #e4dcb8;
	--color-limestone-400: #d2c595;
	--color-limestone-900: #4a4538;

	/* Iron */
	--color-iron: #2d2a2e;
	--color-iron-light: #4a474b;
	--color-iron-muted: #787579;

	/* Primary */
	--color-primary: #f55677;
	--color-primary-light: #ff8fa3;
	--color-primary-dark: #d94462;

	/* --- SHADOWS --- */
	--shadow-retro: 5px 5px 0px 0px rgba(45, 42, 46, 0.1);
	--shadow-retro-hover: 8px 8px 0px 0px rgba(45, 42, 46, 0.15);
	--shadow-retro-primary: 5px 5px 0px 0px #f55677;
	--shadow-retro-white: 5px 5px 0px 0px #ffffff;
	--shadow-retro-sm: 3px 3px 0px 0px rgba(45, 42, 46, 0.08);

	/* --- BACKGROUNDS --- */
	--image-paper-texture: url('https://www.transparenttextures.com/patterns/cream-paper.png');
}

:root {
	--background-color: #fcfbf7;
	--foreground-color: #2d2a2e;
	--primary-color: #f55677;
}

.dark {
	--background-color: #181719;
	--foreground-color: #fcfbf7;
	--primary-color: #f55677;
}

@layer base {
	html {
		@apply bg-[var(--background-color)] text-[var(--foreground-color)] antialiased transition-colors duration-300;
	}

	h1, h2, h3, h4, h5, h6 {
		@apply font-heading text-iron dark:text-limestone-50;
	}

	body {
		@apply font-sans;
		position: relative;
	}

	body::before {
		content: "";
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png');
		opacity: 0.6;
		pointer-events: none;
		z-index: -1;
	}

	body::after {
		content: "";
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: -2;

		background-image: url('/images/tulip_tile.png');
		background-repeat: repeat;
		background-size: 1024px;
		background-attachment: fixed;
	}
}

@utility btn-base {
	@apply inline-flex items-center justify-center gap-2 transition-all duration-200
	outline-none font-heading font-bold tracking-widest uppercase text-sm cursor-pointer
	rounded-none border-0;
}

@utility btn-atelier-primary {
	@apply btn-base px-6 py-3 md:px-10 md:py-4 bg-primary text-white
	border-2 border-black dark:border-white
	shadow-[4px_4px_0px_0px_#000] dark:shadow-[4px_4px_0px_0px_#fff]
	hover:-translate-y-1 hover:shadow-[6px_6px_0px_0px_#000] dark:hover:shadow-[6px_6px_0px_0px_#fff] hover:brightness-110
	active:translate-y-0 active:shadow-none
	disabled:opacity-70 disabled:cursor-wait disabled:translate-y-0 disabled:shadow-none;
}

@utility surface-atelier {
	@apply bg-white dark:bg-[#252426]
	border-2 border-black dark:border-white
	shadow-[4px_4px_0px_0px_#000] dark:shadow-[4px_4px_0px_0px_#fff]
	rounded-lg transition-all duration-300;
}

@layer components {
	/* --- GLASS PANEL (Strong Borders) --- */
	.panel-backdrop {
		@apply bg-limestone-50/80 dark:bg-[#181719]/80 backdrop-blur-md
			/* Strong Black/White Borders */
		border-2 border-black dark:border-white
			/* Optional: Hard Shadow for pop */
		shadow-[4px_4px_0px_0px_#000] dark:shadow-[4px_4px_0px_0px_#fff]
		transition-all duration-300;
	}

	/* --- TYPOGRAPHY --- */
	.heading-page {
		@apply text-4xl md:text-7xl font-heading italic text-iron dark:text-limestone-50 mb-4 md:mb-6 tracking-tight;
	}

	.heading-section {
		@apply text-2xl md:text-4xl font-bold font-heading text-iron dark:text-limestone-50 mb-3 md:mb-4;
	}

	.text-body {
		@apply text-base md:text-lg text-iron-muted dark:text-limestone-300 leading-relaxed font-sans;
	}

	.btn-atelier-dark {
		@apply btn-base px-6 py-3 md:px-8 md:py-4 bg-iron dark:bg-limestone-100 text-white dark:text-iron
		border-2 border-black dark:border-white
		shadow-[4px_4px_0px_0px_#f55677] dark:shadow-[4px_4px_0px_0px_#2d2a2e]
		hover:-translate-y-1 hover:shadow-[6px_6px_0px_0px_#f55677] dark:hover:shadow-[6px_6px_0px_0px_#2d2a2e] hover:brightness-110
		active:translate-y-0 active:shadow-none
		disabled:bg-iron/20 disabled:text-iron/40 disabled:shadow-none
		dark:disabled:bg-limestone-50/10 dark:disabled:text-limestone-50/40;
	}

	.btn-atelier-outline {
		@apply btn-base px-6 py-3 md:px-8 md:py-4 bg-transparent text-iron dark:text-limestone-50
		border-2 border-iron dark:border-limestone-50
		shadow-[4px_4px_0px_0px_#000] dark:shadow-[4px_4px_0px_0px_#fff]
		hover:-translate-y-1 hover:bg-iron hover:text-white dark:hover:bg-limestone-50 dark:hover:text-iron
		active:translate-y-0 active:shadow-none
		disabled:opacity-50;
	}

	.btn-atelier-ghost {
		@apply btn-base px-4 py-2 md:px-6 md:py-3 bg-transparent text-iron-muted dark:text-limestone-400
		hover:text-primary dark:hover:text-white hover:bg-iron/5 dark:hover:bg-limestone-50/10
		disabled:opacity-0;
	}

	.btn-atelier { @apply btn-atelier-primary; }

	.surface-interactive,
	.card-interactive {
		@apply surface-atelier cursor-pointer text-left outline-none relative p-6 md:p-8
		hover:border-primary hover:-translate-y-1
		hover:shadow-[6px_6px_0px_0px_#000] dark:hover:shadow-[6px_6px_0px_0px_#fff];
	}

	.surface-interactive[data-state='active'],
	.card-interactive[data-state='active'] {
		@apply border-primary shadow-none translate-y-0 bg-primary/5;
	}

	/* --- IMAGES & MEDIA FRAMES --- */
	.frame-atelier {
		@apply relative p-2 bg-white dark:bg-[#252426]
		border-2 border-black dark:border-white
		shadow-[4px_4px_0px_0px_#000] dark:shadow-[4px_4px_0px_0px_#fff]
		transition-transform duration-500;
	}

	.frame-icon {
		@apply flex items-center justify-center border-2 rounded-lg transition-colors duration-300;
	}

	/* --- FORMS --- */
	.input-atelier {
		@apply w-full bg-transparent border-b-2 border-black/20 dark:border-white/20
		px-2 py-3 text-base md:text-lg font-medium outline-none transition-all duration-300
		text-iron dark:text-limestone-50
		placeholder:text-iron-muted/40 dark:placeholder:text-limestone-400/40
		focus:border-primary focus:bg-limestone-50/50 dark:focus:bg-iron-light/20;
	}

	/* --- WIZARD STEPS --- */
	.step-indicator {
		@apply w-8 h-8 sm:w-12 sm:h-12 rounded-full flex items-center justify-center text-xs sm:text-sm font-bold transition-all duration-300 border-2;
	}
	.step-indicator.active {
		@apply bg-iron text-white border-black shadow-[2px_2px_0px_0px_#000] dark:shadow-[2px_2px_0px_0px_#fff] translate-y-[-2px] scale-105 dark:bg-limestone-100 dark:text-iron;
	}
	.step-indicator.inactive {
		@apply bg-white dark:bg-[#252426] border-iron/20 text-iron/40 dark:border-iron-light dark:text-iron-muted;
	}
	.step-indicator.completed {
		@apply bg-primary text-white border-primary;
	}

	/* --- CALENDAR COMPONENTS --- */
	.calendar-container {
		@apply select-none relative z-10 w-full;
	}

	.calendar-header-row {
		@apply flex items-center justify-between pb-8 pt-2;
	}

	.calendar-nav-btn {
		@apply w-9 h-9 rounded-full flex items-center justify-center
		border border-iron/20 text-iron dark:text-limestone-300 dark:border-limestone-100/20
		hover:bg-iron hover:text-white hover:scale-110 active:scale-95
		dark:hover:bg-limestone-100 dark:hover:text-iron
		transition-all duration-300 cursor-pointer;
	}

	.calendar-heading {
		@apply text-xl font-heading font-bold text-iron dark:text-limestone-50 capitalize select-none tabular-nums;
	}

	.calendar-grid {
		@apply w-full border-collapse;
	}

	.calendar-weekday-header {
		@apply w-10 text-[10px] uppercase tracking-widest font-bold text-center select-none;
	}

	.calendar-day-wrapper {
		@apply relative p-0 m-0;
	}

	/* The animated day cell base */
	.calendar-day {
		@apply w-10 h-10 flex items-center justify-center relative z-10 font-sans cursor-pointer
		rounded-lg overflow-hidden;
		transition: all 0.3s ease;
		backface-visibility: hidden;
	}

	/* === NEW CALENDAR STATE CLASSES === */

	/* 1. Endpoint Selected (Start/End) - Pink Background, White Text */
	.cal-day-selected-endpoint {
		@apply bg-primary text-white font-bold opacity-100 scale-105 shadow-md z-20;
	}

	/* 2. Range Selected (Middle) - Light Pink Background, Primary Pink Text */
	.cal-day-selected-range {
		@apply bg-primary/15 text-primary font-medium;
	}

	/* 3. Restricted (Past dates) - Grayed out */
	.cal-day-restricted {
		@apply text-iron-muted/40 cursor-not-allowed line-through decoration-iron-muted/40;
	}

	/* 4. Blocked (By Booking Logic/Barriers) - Faded */
	.cal-day-blocked {
		@apply text-iron-muted/30 cursor-not-allowed bg-black/5 dark:bg-white/5;
	}

	/* 5. Booked (Striped Pattern) - Red */
	.cal-day-booked {
		@apply text-red-700 dark:text-red-300 line-through decoration-red-300 dark:decoration-red-700 cursor-not-allowed;
		background-image: linear-gradient(45deg, rgba(220, 38, 38, 0.15) 25%, transparent 25%, transparent 50%, rgba(220, 38, 38, 0.15) 50%, rgba(245, 86, 119, 0.15) 75%, transparent 75%, transparent);
		background-size: 8px 8px;
	}

	/* 6. Invalid Selection (Booked date inside a selection range) - Red BG */
	.cal-day-invalid-selection {
		@apply bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-200 line-through decoration-red-400;
		background-image: linear-gradient(45deg, rgba(220, 38, 38, 0.15) 25%, transparent 25%, transparent 50%, rgba(220, 38, 38, 0.15) 50%, rgba(245, 86, 119, 0.15) 75%, transparent 75%, transparent);
		background-size: 8px 8px;
	}

	/* 7. Partial Availability (Amber) - FIXED CONTRAST */
	.cal-day-partial {
		@apply bg-amber-100 text-amber-900 dark:bg-amber-900/50 dark:text-amber-100 font-medium;
	}

	/* Dimmed (Outside month) */
	.cal-day-dimmed {
		@apply text-iron-muted/40 dark:text-limestone-400/40;
	}

	/* Selection Info Box */
	.calendar-info-box {
		@apply flex items-center gap-4 p-4 border-l-4 border-primary bg-primary/5 dark:bg-primary/10 rounded-r-lg;
	}

	/* --- CALENDAR LEGEND --- */
	.calendar-legend {
		@apply flex flex-wrap items-center gap-x-6 gap-y-2 mt-6 pt-4 border-t-2 border-iron/5 dark:border-limestone-100/5 text-sm font-medium text-iron/60 dark:text-limestone-300;
	}

	.calendar-legend-item {
		@apply flex items-center gap-2;
	}

	.legend-indicator {
		@apply w-4 h-4 rounded-md border;
	}

	.legend-indicator.available {
		@apply border-iron/20 bg-transparent dark:border-limestone-100/20;
	}

	.legend-indicator.booked {
		@apply bg-red-100 dark:bg-red-900/20 border-red-200 dark:border-red-900/30;
		background-image: linear-gradient(45deg, rgba(245, 86, 119, 0.15) 25%, transparent 25%, transparent 50%, rgba(245, 86, 119, 0.15) 50%, rgba(245, 86, 119, 0.15) 75%, transparent 75%, transparent);
		background-size: 6px 6px;
	}

	.legend-indicator.partial {
		@apply bg-amber-100 dark:bg-amber-900/50 border-amber-200 dark:border-amber-700/30;
	}

	.legend-indicator.past {
		@apply bg-iron/5 border-iron/10 opacity-30 dark:bg-limestone-100/5 dark:border-limestone-100/10;
	}
}